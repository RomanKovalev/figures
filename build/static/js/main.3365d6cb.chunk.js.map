{"version":3,"sources":["components/boxitem/index.js","components/boxitem/boxitem.js","services/fetch-service.js","components/app/index.js","components/app/app.js","index.js"],"names":["Boxitem","_ref","state","onMouseDown","onDragStart","react_default","a","createElement","className","draggable","e","id","style","top","left","width","height","FetchService","_apiBase","url","fetch","res","ok","Error","concat","status","json","this","getResource","body","method","headers","Accept","Content-Type","JSON","stringify","accessResource","App","_this","Object","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","fetchService","items","resizer","onDrop","ev","preventDefault","dataTransfer","getData","figure","filter","obj","console","log","offsetx","clientX","clientY","offsety","offset","split","parseInt","updateFigure","getFigures","setState","onDragOver","onMouseUp","window","getComputedStyle","target","setData","getPropertyValue","setDragImage","outerWidth","outerHeight","delAll","delFigures","getRandomInt","min","max","Math","floor","random","addFigure","newFigure","postFigure","_this2","then","figures","_this3","answer","_this4","_this5","_this6","listItems","map","p","components_boxitem","key","onClick","Component","ReactDOM","render","components_app","document","getElementById"],"mappings":"qPAEeA,SCEC,SAAAC,GAAyC,IAAtCC,EAAsCD,EAAtCC,MAAOC,EAA+BF,EAA/BE,YAAaC,EAAkBH,EAAlBG,YACnC,OACIC,EAAAC,EAAAC,cAAA,OACIC,UAAU,OACVC,UAAWP,EAAMO,UACjBL,YAAa,SAACM,GAAD,OAAON,EAAYM,EAAGR,EAAMS,KACzCC,MACI,CACIC,IAAKX,EAAMW,IAAM,KACjBC,KAAMZ,EAAMY,KAAO,KACnBC,MAAOb,EAAMa,MAAQ,KACrBC,OAAQd,EAAMc,OAAS,OAI/BX,EAAAC,EAAAC,cAAA,OACIC,UAAU,kBACVL,YAAa,SAACO,GAAD,OAAOP,EAAYO,EAAGR,EAAMS,OAE7CN,EAAAC,EAAAC,cAAA,OACIC,UAAU,mBACVL,YAAa,SAACO,GAAD,OAAOP,EAAYO,EAAGR,EAAMS,OAE7CN,EAAAC,EAAAC,cAAA,OACIC,UAAU,qBACVL,YAAa,SAACO,GAAD,OAAOP,EAAYO,EAAGR,EAAMS,OAE7CN,EAAAC,EAAAC,cAAA,OACIC,UAAU,sBACVL,YAAa,SAACO,GAAD,OAAOP,EAAYO,EAAGR,EAAMS,iCCjCpCM,mDAEnBC,SAAW,6HAEOC,yFACEC,MAAMD,cAAlBE,UACGC,yBACD,IAAIC,MAAM,mBAAAC,OAAmBL,GAAnB,cAAAK,OAAyCH,EAAII,gCAElDJ,EAAIK,gTAICC,KAAKC,YAAYD,KAAKT,SAAW,sBAA7CG,2BACCA,oLAGYQ,EAAMV,EAAKW,yFACZV,MAAMD,EAAK,CAC3BW,OAAQA,EACRC,QAAS,CACPC,OAAU,mBACVC,eAAgB,oBAElBJ,KAAMK,KAAKC,UAAUN,gBANjBR,UAQGC,yBACD,IAAIC,MAAM,mBAAAC,OAAmBL,GAAnB,cAAAK,OAAyCH,EAAII,gCAElDJ,EAAIK,4NAGFG,8FAAMV,iCAAMQ,KAAKT,SAAW,gBACzBS,KAAKS,eAAeP,EAAMV,EAAK,sBAA3CE,2BACCA,8QAGQF,iCAAMQ,KAAKT,SAAW,gBACnBS,KAAKS,eAAe,KAAMjB,EAAK,wBAA3CE,2BACCA,kLAGUQ,EAAMlB,kFACjBQ,EAAMQ,KAAKT,SAAW,UAAYP,EAAK,aAC3BgB,KAAKS,eAAeP,EAAMV,EAAK,uBAA3CE,2BACCA,iHC3CIgB,qBCMb,SAAAA,IAAc,IAAAC,EAAA,OAAAC,OAAAC,EAAA,EAAAD,CAAAZ,KAAAU,IACZC,EAAAC,OAAAE,EAAA,EAAAF,CAAAZ,KAAAY,OAAAG,EAAA,EAAAH,CAAAF,GAAAM,KAAAhB,QAIFiB,aAAe,IAAI3B,EALLqB,EAOdpC,MAAQ,CACN2C,MAAO,GACPC,QAAS,MATGR,EA6CdS,OAAS,SAACC,GACRA,EAAGC,iBACH,IAAMtC,EAAKqC,EAAGE,aAAaC,QAAQ,MAC7BC,EAASd,EAAKpC,MAAM2C,MAAMQ,OAAO,SAAAC,GACrC,OAAOA,EAAI3C,IAAMA,IAEnB,GAAMyC,EAAO,GAAI,CACf,IAAIrC,EAAOC,EAAQH,EAAKC,EAIxB,GAHAC,EAAQqC,EAAO,GAAGrC,MAClBC,EAASoC,EAAO,GAAGpC,OACnBuC,QAAQC,IAAIJ,EAAO,GAAGK,SACK,oBAAvBnB,EAAKpC,MAAM4C,QACb/B,EAAQqC,EAAO,GAAGrC,OAASiC,EAAGU,QAAUN,EAAO,GAAGtC,MAClDE,EAASoC,EAAO,GAAGpC,QAAUgC,EAAGW,QAAUP,EAAO,GAAGvC,KACpDC,EAAOkC,EAAGU,QACV7C,EAAMmC,EAAGW,aACJ,GAA2B,qBAAvBrB,EAAKpC,MAAM4C,QACpB/B,EAAQqC,EAAO,GAAGrC,OAASqC,EAAO,GAAGK,QAAUT,EAAGU,SAClD7C,EAAMmC,EAAGW,QACT3C,EAASoC,EAAO,GAAGpC,QAAUgC,EAAGW,QAAUP,EAAO,GAAGvC,KACpDC,EAAOsC,EAAO,GAAGtC,UACZ,GAA2B,uBAAvBwB,EAAKpC,MAAM4C,QACpB/B,EAAQqC,EAAO,GAAGrC,OAASiC,EAAGU,QAAUN,EAAO,GAAGtC,MAClDA,EAAOkC,EAAGU,QACV1C,EAASoC,EAAO,GAAGpC,QAAUoC,EAAO,GAAGQ,QAAUZ,EAAGW,SACpD9C,EAAMuC,EAAO,GAAGvC,SACX,GAA2B,wBAAvByB,EAAKpC,MAAM4C,QACpB/B,EAAQqC,EAAO,GAAGrC,OAASqC,EAAO,GAAGK,QAAUT,EAAGU,SAClD1C,EAASoC,EAAO,GAAGpC,QAAUoC,EAAO,GAAGQ,QAAUZ,EAAGW,SACpD9C,EAAMuC,EAAO,GAAGvC,IAChBC,EAAOsC,EAAO,GAAGtC,SACZ,CACL,IAAM+C,EAASb,EAAGE,aAAaC,QAAQ,cAAcW,MAAM,KAC3DhD,EAAOkC,EAAGU,QAAUK,SAASF,EAAO,GAAI,IACxChD,EAAMmC,EAAGW,QAAUI,SAASF,EAAO,GAAI,IAEzC,IAAMhC,EAAO,CACXf,KAAQA,EACRD,IAAOA,EACPE,MAASA,EACTC,OAAUA,GAKZ,OAHAsB,EAAK0B,aAAanC,EAAMlB,GACxB2B,EAAK2B,aACL3B,EAAK4B,SAAS,CAAEpB,QAAW,QACpB,IA1FGR,EA8Fd6B,WAAa,SAACnB,GACZA,EAAGC,kBA/FSX,EAkGd8B,UAAY,SAACpB,GACXA,EAAGC,kBAnGSX,EAsGdlC,YAAc,SAAC4C,EAAIrC,GACjB,IAAIC,EAAQyD,OAAOC,iBAAiBtB,EAAGuB,OAAQ,MAC/CvB,EAAGE,aAAasB,QAAQ,aACrBT,SAASnD,EAAM6D,iBAAiB,QAAS,IAAMzB,EAAGU,QAAW,KAAOK,SAASnD,EAAM6D,iBAAiB,OAAQ,IAAMzB,EAAGW,UACxHX,EAAGE,aAAawB,aAAa1B,EAAGuB,OAAQF,OAAOM,WAAYN,OAAOO,aAClE5B,EAAGE,aAAasB,QAAQ,KAAM7D,IA3GlB2B,EA8GdnC,YAAc,SAAC6C,EAAIrC,GACjB,IAAM8C,EAAUT,EAAGU,QACbE,EAAUZ,EAAGW,QACnBrB,EAAK4B,SAAS,CAAEpB,QAAWE,EAAGuB,OAAO/D,YACrC,IAAMqB,EAAO,CACX4B,QAAWA,EACXG,QAAWA,GAGb,OADAtB,EAAK0B,aAAanC,EAAMlB,IACjB,GAvHK2B,EA0HduC,OAAS,WACPvC,EAAKwC,cA3HOxC,EA8HdyC,aAAe,SAACC,EAAKC,GACnB,OAAOC,KAAKC,MAAMD,KAAKE,UAAYH,EAAMD,IAAQA,GA/HrC1C,EAkId+C,UAAY,WACV,IAAMC,EAAY,CAChBxE,KAAMwB,EAAKyC,aAAa,GAAI,KAC5BlE,IAAKyB,EAAKyC,aAAa,GAAI,KAC3BhE,MAAOuB,EAAKyC,aAAa,GAAI,KAC7B/D,OAAQsB,EAAKyC,aAAa,GAAI,KAC9BtE,WAAW,EACXgD,QAAS,EACTG,QAAS,GAEXtB,EAAKiD,WAAWD,GAChBhD,EAAK2B,cA3IL3B,EAAK2B,aAFO3B,4EAaD,IAAAkD,EAAA7D,KACXA,KAAKiB,aACFqB,aACAwB,KAAK,SAACC,GACLF,EAAKtB,SAAS,CAAErB,MAAS6C,yCAIpB7D,GAAM,IAAA8D,EAAAhE,KACfA,KAAKiB,aACF2C,WAAW1D,GACX4D,KAAK,SAACG,GACLD,EAAK1B,oDAIE,IAAA4B,EAAAlE,KACXA,KAAKiB,aACJkC,aACAW,KAAK,SAACG,GACLC,EAAK5B,oDAIIpC,EAAMlB,GAAI,IAAAmF,EAAAnE,KACrBA,KAAKiB,aACJoB,aAAanC,EAAMlB,GACnB8E,KAAK,SAACG,GACLE,EAAK7B,gDAuGA,IAAA8B,EAAApE,KACDqE,EAAYrE,KAAKzB,MAAM2C,MAAMoD,IAAI,SAACC,GAAD,OACrC7F,EAAAC,EAAAC,cAAC4F,EAAD,CACEjG,MAAOgG,EACPE,IAAKF,EAAEvF,GACPP,YAAa2F,EAAK3F,YAClBD,YAAa4F,EAAK5F,gBAItB,OACEE,EAAAC,EAAAC,cAAA,WACEF,EAAAC,EAAAC,cAAA,OAAKC,UAAU,kBAEbH,EAAAC,EAAAC,cAAA,OAAKC,UAAU,UACb2D,WAAY,SAACzD,GAAD,OAAOqF,EAAK5B,WAAWzD,IACnCqC,OAAQ,SAACrC,GAAD,OAAOqF,EAAKhD,OAAOrC,IAC3B0D,UAAW,SAAC1D,GAAD,OAAOqF,EAAK3B,UAAU1D,KAEjCL,EAAAC,EAAAC,cAAA,OAAKC,UAAU,eACbH,EAAAC,EAAAC,cAAA,UACE8F,QAAS1E,KAAK0D,WADhB,SAIShF,EAAAC,EAAAC,cAAA,WACTF,EAAAC,EAAAC,cAAA,UACE8F,QAAS1E,KAAKkD,QADhB,cAMDmB,YAjLoBM,cCFjCC,IAASC,OAAOnG,EAAAC,EAAAC,cAACkG,EAAD,MACdC,SAASC,eAAe","file":"static/js/main.3365d6cb.chunk.js","sourcesContent":["import Boxitem from './boxitem';\n\nexport default Boxitem;","import React from 'react';\n\nimport './boxitem.css'\n\nconst Boxitem = ({ state, onMouseDown, onDragStart }) => {\n    return (\n        <div\n            className=\"area\"\n            draggable={state.draggable}\n            onDragStart={(e) => onDragStart(e, state.id)}\n            style={\n                {\n                    top: state.top + 'px',\n                    left: state.left + 'px',\n                    width: state.width + 'px',\n                    height: state.height + 'px',\n                }\n            }\n        >\n            <div\n                className=\"corner left-top\"\n                onMouseDown={(e) => onMouseDown(e, state.id)}\n            ></div>\n            <div\n                className=\"corner right-top\"\n                onMouseDown={(e) => onMouseDown(e, state.id)}\n            ></div>\n            <div\n                className=\"corner left-bottom\"\n                onMouseDown={(e) => onMouseDown(e, state.id)}\n            ></div>\n            <div\n                className=\"corner right-bottom\"\n                onMouseDown={(e) => onMouseDown(e, state.id)}\n            ></div>\n        </div>\n    );\n}\n\nexport default Boxitem;","export default class FetchService {\n\n  _apiBase = 'http://127.0.0.1:8000/api/'\n\n  async getResource(url) {\n    const res = await fetch(url)\n    if (!res.ok) {\n      throw new Error(`Could not fetch ${url}` + `, received ${res.status}`)\n    }\n    return await res.json()\n  };\n\n  async getFigures() {\n    const res = await this.getResource(this._apiBase + 'list')\n    return res\n  }\n\n  async accessResource(body, url, method) {\n    const res = await fetch(url, {\n      method: method,\n      headers: {\n        'Accept': 'application/json',\n        'Content-Type': 'application/json'\n      },\n      body: JSON.stringify(body)\n    })\n    if (!res.ok) {\n      throw new Error(`Could not fetch ${url}` + `, received ${res.status}`)\n    }\n    return await res.json()\n  };\n\n  async postFigure(body, url = this._apiBase + 'list') {\n    const res = await this.accessResource(body, url, 'POST')\n    return res\n  }\n\n  async delFigures(url = this._apiBase + 'list') {\n    const res = await this.accessResource(null, url, 'DELETE')\n    return res\n  }\n\n  async updateFigure(body, id) {\n    const url = this._apiBase + 'update/' + id + '/'\n    const res = await this.accessResource(body, url, 'PATCH')\n    return res\n  }\n}","import App from './app';\n\nexport default App;","import React, { Component } from 'react';\nimport Boxitem from \"../boxitem\";\n\nimport FetchService from \"../../services/fetch-service\";\nimport './app.css'\n\nexport default class App extends Component {\n\n  constructor() {\n    super();\n    this.getFigures();\n  }\n\n  fetchService = new FetchService();\n\n  state = {\n    items: [],\n    resizer: null\n\n  }\n\n  getFigures() {\n    this.fetchService\n      .getFigures()\n      .then((figures) => {\n        this.setState({ 'items': figures })\n      })\n  };\n\n  postFigure(body) {\n    this.fetchService\n      .postFigure(body)\n      .then((answer) => {\n        this.getFigures()\n      })\n  }\n\n  delFigures() {\n    this.fetchService\n    .delFigures()\n    .then((answer) => {\n      this.getFigures()\n    })\n  }\n\n  updateFigure(body, id) {\n    this.fetchService\n    .updateFigure(body, id)\n    .then((answer) => {\n      this.getFigures()\n    })\n  }  \n  \n  onDrop = (ev) => {\n    ev.preventDefault();\n    const id = ev.dataTransfer.getData(\"id\")\n    const figure = this.state.items.filter(obj => {\n      return obj.id == id\n    })\n    if (!!figure[0]) {\n      let width, height, top, left\n      width = figure[0].width\n      height = figure[0].height\n      console.log(figure[0].offsetx)\n      if (this.state.resizer === 'corner left-top') {\n        width = figure[0].width - (ev.clientX - figure[0].left)\n        height = figure[0].height - (ev.clientY - figure[0].top)\n        left = ev.clientX\n        top = ev.clientY\n      } else if (this.state.resizer === 'corner right-top') {\n        width = figure[0].width - (figure[0].offsetx - ev.clientX)\n        top = ev.clientY\n        height = figure[0].height - (ev.clientY - figure[0].top)\n        left = figure[0].left\n      } else if (this.state.resizer === 'corner left-bottom') {\n        width = figure[0].width - (ev.clientX - figure[0].left)\n        left = ev.clientX\n        height = figure[0].height - (figure[0].offsety - ev.clientY)\n        top = figure[0].top\n      } else if (this.state.resizer === 'corner right-bottom') {\n        width = figure[0].width - (figure[0].offsetx - ev.clientX)\n        height = figure[0].height - (figure[0].offsety - ev.clientY)\n        top = figure[0].top\n        left = figure[0].left\n      } else {\n        const offset = ev.dataTransfer.getData(\"text/plain\").split(',')\n        left = ev.clientX + parseInt(offset[0], 10)\n        top = ev.clientY + parseInt(offset[1], 10)\n      }\n      const body = {\n        \"left\": left,\n        \"top\": top,\n        \"width\": width,\n        \"height\": height\n      }\n      this.updateFigure(body, id)\n      this.getFigures()\n      this.setState({ 'resizer': null })\n      return false;\n    }\n  }\n\n  onDragOver = (ev) => {\n    ev.preventDefault();\n  }\n\n  onMouseUp = (ev) => {\n    ev.preventDefault()\n  }\n\n  onDragStart = (ev, id) => {\n    let style = window.getComputedStyle(ev.target, null);\n    ev.dataTransfer.setData(\"text/plain\",\n      (parseInt(style.getPropertyValue(\"left\"), 10) - ev.clientX) + ',' + (parseInt(style.getPropertyValue(\"top\"), 10) - ev.clientY));\n    ev.dataTransfer.setDragImage(ev.target, window.outerWidth, window.outerHeight)\n    ev.dataTransfer.setData('id', id)\n  }\n\n  onMouseDown = (ev, id) => {\n    const offsetx = ev.clientX\n    const offsety = ev.clientY\n    this.setState({ 'resizer': ev.target.className })\n    const body = {\n      \"offsetx\": offsetx,\n      \"offsety\": offsety,\n    }\n    this.updateFigure(body, id)\n    return false;\n  }\n\n  delAll = () => {\n    this.delFigures()\n  };\n\n  getRandomInt = (min, max) => {\n    return Math.floor(Math.random() * (max - min)) + min;\n  };\n\n  addFigure = () => {\n    const newFigure = {\n      left: this.getRandomInt(10, 900),\n      top: this.getRandomInt(10, 900),\n      width: this.getRandomInt(40, 300),\n      height: this.getRandomInt(40, 300),\n      draggable: true,\n      offsetx: 0,\n      offsety: 0,\n    }\n    this.postFigure(newFigure);\n    this.getFigures();\n  };\n\n  render() {\n    const listItems = this.state.items.map((p) =>\n      <Boxitem\n        state={p}\n        key={p.id}\n        onDragStart={this.onDragStart}\n        onMouseDown={this.onMouseDown}\n      />\n\n    );\n    return (\n      <div>\n        <div className=\"container-drag\">\n\n          <div className=\"wrapper\"\n            onDragOver={(e) => this.onDragOver(e)}\n            onDrop={(e) => this.onDrop(e)}\n            onMouseUp={(e) => this.onMouseUp(e)}\n          >\n            <div className=\"bnt-wrapper\">\n              <button\n                onClick={this.addFigure}\n              >\n                Add +\n              </button><br />\n              <button\n                onClick={this.delAll}\n              >\n                Clear all\n              </button>\n            </div>\n            {listItems}\n          </div>\n        </div>\n      </div>\n    );\n  };\n}\n\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './components/app';\n\nReactDOM.render(<App />,\n  document.getElementById('root'));"],"sourceRoot":""}